<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì±„íŒ… í…ŒìŠ¤íŠ¸ í˜ì´ì§€</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .message-bubble {
            max-width: 70%;
            word-wrap: break-word;
        }
        .message-sent {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 18px 18px 4px 18px;
        }
        .message-received {
            background: #f1f5f9;
            color: #1e293b;
            border-radius: 18px 18px 18px 4px;
        }
        .typing-indicator {
            display: none;
        }
        .typing-indicator.show {
            display: flex;
        }
        .typing-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: #9ca3af;
            animation: typing 1.4s infinite ease-in-out;
        }
        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }
        @keyframes typing {
            0%, 80%, 100% { transform: scale(0.8); opacity: 0.5; }
            40% { transform: scale(1); opacity: 1; }
        }
        .room-card {
            transition: all 0.3s ease;
        }
        .room-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        .member-online {
            position: relative;
        }
        .member-online::after {
            content: '';
            position: absolute;
            bottom: 2px;
            right: 2px;
            width: 12px;
            height: 12px;
            background-color: #10b981;
            border: 2px solid white;
            border-radius: 50%;
        }
    </style>
</head>
<body class="min-h-screen bg-gray-100">
    <!-- Header -->
    <header class="bg-white shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-6">
                <div class="flex items-center">
                    <a href="/" class="text-2xl font-bold text-gray-900 hover:text-blue-600">â† Intune Chat</a>
                </div>
                <nav class="flex space-x-4">
                    <a href="/" class="text-gray-600 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium">
                        í™ˆìœ¼ë¡œ
                    </a>
                    <a href="/simple-test.html" class="text-gray-600 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium">
                        ê°„ë‹¨í•œ í…ŒìŠ¤íŠ¸
                    </a>
                </nav>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <h1 class="text-3xl font-bold text-center mb-8 text-gray-800">
            ğŸ’¬ ì±„íŒ… ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸
        </h1>

        <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
            <!-- ì±„íŒ…ë°© ëª©ë¡ -->
            <div class="lg:col-span-1 bg-white rounded-lg shadow-md p-4">
                <h2 class="text-xl font-semibold mb-4 text-gray-700">ì±„íŒ…ë°© ëª©ë¡</h2>
                <div class="space-y-2" id="room-list">
                    <!-- ì±„íŒ…ë°©ë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                </div>
            </div>

            <!-- ì±„íŒ… ë©”ì‹œì§€ ì˜ì—­ -->
            <div class="lg:col-span-2 bg-white rounded-lg shadow-md flex flex-col h-96">
                <div id="chat-container">
                    <!-- ì±„íŒ…ë°© í—¤ë” -->
                    <div class="p-4 border-b border-gray-200" id="chat-header" style="display: none;">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-3">
                                <div class="w-10 h-10 rounded-full bg-blue-500 flex items-center justify-center text-white font-semibold" id="room-avatar">
                                    ğŸ’¬
                                </div>
                                <div>
                                    <h3 class="font-semibold text-gray-900" id="room-name">
                                        ì±„íŒ…ë°© ì´ë¦„
                                    </h3>
                                    <p class="text-sm text-gray-500" id="room-info">
                                        0ëª… ì°¸ì—¬ ì¤‘
                                    </p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-2">
                                <span class="px-2 py-1 text-xs rounded-full bg-blue-100 text-blue-800" id="room-type">
                                    ê°œì¸
                                </span>
                            </div>
                        </div>
                    </div>

                    <!-- ë©”ì‹œì§€ ëª©ë¡ -->
                    <div class="flex-1 overflow-y-auto p-4 space-y-4" id="messages-container">
                        <div class="text-center text-gray-500 py-8">
                            ì±„íŒ…ë°©ì„ ì„ íƒí•´ì£¼ì„¸ìš”
                        </div>
                    </div>

                    <!-- ë©”ì‹œì§€ ì…ë ¥ -->
                    <div class="p-4 border-t border-gray-200" id="message-input" style="display: none;">
                        <div class="flex space-x-2">
                            <select id="message-type" class="px-3 py-2 border border-gray-300 rounded-lg text-sm">
                                <option value="text">í…ìŠ¤íŠ¸</option>
                                <option value="image">ì´ë¯¸ì§€</option>
                                <option value="file">íŒŒì¼</option>
                                <option value="system">ì‹œìŠ¤í…œ</option>
                                <option value="bot">ë´‡</option>
                            </select>
                            <input
                                type="text"
                                id="message-text"
                                placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”..."
                                class="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                            />
                            <button
                                onclick="sendMessage()"
                                class="px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500"
                            >
                                ì „ì†¡
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ë©¤ë²„ ëª©ë¡ -->
            <div class="lg:col-span-1 bg-white rounded-lg shadow-md p-4">
                <h2 class="text-xl font-semibold mb-4 text-gray-700">ë©¤ë²„ ëª©ë¡</h2>
                <div class="space-y-3" id="member-list">
                    <!-- ë©¤ë²„ë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                </div>
            </div>
        </div>

        <!-- í…ŒìŠ¤íŠ¸ ì •ë³´ -->
        <div class="mt-8 bg-white rounded-lg shadow-md p-6">
            <h2 class="text-xl font-semibold mb-4 text-gray-700">í…ŒìŠ¤íŠ¸ ê¸°ëŠ¥</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                <div class="p-4 bg-blue-50 rounded-lg">
                    <h3 class="font-medium text-blue-900">ì±„íŒ…ë°© íƒ€ì…</h3>
                    <p class="text-sm text-blue-700 mt-1">
                        ê°œì¸, ê·¸ë£¹, ê³µê°œ, íŒ€ ì±„íŒ…ë°© êµ¬ë¶„
                    </p>
                </div>
                <div class="p-4 bg-green-50 rounded-lg">
                    <h3 class="font-medium text-green-900">ë©”ì‹œì§€ íƒ€ì…</h3>
                    <p class="text-sm text-green-700 mt-1">
                        í…ìŠ¤íŠ¸, ì´ë¯¸ì§€, íŒŒì¼, ì‹œìŠ¤í…œ, ë´‡ ë©”ì‹œì§€
                    </p>
                </div>
                <div class="p-4 bg-purple-50 rounded-lg">
                    <h3 class="font-medium text-purple-900">ë©”ì‹œì§€ ìƒíƒœ</h3>
                    <p class="text-sm text-purple-700 mt-1">
                        ì „ì†¡ ì¤‘, ì „ì†¡ ì™„ë£Œ, ì „ë‹¬ë¨, ì½ìŒ, ì‹¤íŒ¨
                    </p>
                </div>
                <div class="p-4 bg-yellow-50 rounded-lg">
                    <h3 class="font-medium text-yellow-900">ì‚¬ìš©ì ì—­í• </h3>
                    <p class="text-sm text-yellow-700 mt-1">
                        ê´€ë¦¬ì, ë©¤ë²„, ê²ŒìŠ¤íŠ¸ ê¶Œí•œ êµ¬ë¶„
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ë”ë¯¸ ë°ì´í„°
        const dummyRooms = [
            {
                id: '1',
                name: 'ê°œì¸ ì±„íŒ…ë°©',
                description: '1:1 ê°œì¸ ëŒ€í™”',
                type: 'private',
                memberCount: 2,
                avatar: 'ğŸ’¬',
                isPrivate: true,
                isActive: true,
            },
            {
                id: '2',
                name: 'íŒ€ í”„ë¡œì íŠ¸',
                description: 'í”„ë¡œì íŠ¸ íŒ€ ì±„íŒ…',
                type: 'team',
                memberCount: 5,
                avatar: 'ğŸ‘¥',
                isPrivate: false,
                isActive: true,
            },
            {
                id: '3',
                name: 'ê³µê°œ ì±„ë„',
                description: 'ëª¨ë“  ì‚¬ìš©ì ì°¸ì—¬ ê°€ëŠ¥',
                type: 'public',
                memberCount: 15,
                avatar: 'ğŸŒ',
                isPrivate: false,
                isActive: true,
            },
        ];

        const dummyMembers = [
            {
                userId: 'user1',
                username: 'ê¹€ì² ìˆ˜',
                avatar: 'ğŸ‘¨',
                role: 'admin',
                isOnline: true,
                isDnd: false,
            },
            {
                userId: 'user2',
                username: 'ì´ì˜í¬',
                avatar: 'ğŸ‘©',
                role: 'member',
                isOnline: true,
                isDnd: false,
            },
            {
                userId: 'user3',
                username: 'ë°•ë¯¼ìˆ˜',
                avatar: 'ğŸ‘¨â€ğŸ’¼',
                role: 'member',
                isOnline: false,
                isDnd: false,
            },
        ];

        const dummyMessages = {
            '1': [
                {
                    id: '1',
                    senderId: 'user1',
                    senderName: 'ê¹€ì² ìˆ˜',
                    content: 'ì•ˆë…•í•˜ì„¸ìš”!',
                    type: 'text',
                    status: 'read',
                    timestamp: new Date(Date.now() - 60000),
                },
                {
                    id: '2',
                    senderId: 'user2',
                    senderName: 'ì´ì˜í¬',
                    content: 'ë°˜ê°‘ìŠµë‹ˆë‹¤!',
                    type: 'text',
                    status: 'read',
                    timestamp: new Date(Date.now() - 30000),
                },
            ],
            '2': [
                {
                    id: '3',
                    senderId: 'user1',
                    senderName: 'ê¹€ì² ìˆ˜',
                    content: 'í”„ë¡œì íŠ¸ ì§„í–‰ìƒí™©ì€ ì–´ë– ì‹ ê°€ìš”?',
                    type: 'text',
                    status: 'read',
                    timestamp: new Date(Date.now() - 120000),
                },
            ],
            '3': [
                {
                    id: '4',
                    senderId: 'user3',
                    senderName: 'ë°•ë¯¼ìˆ˜',
                    content: 'ì•ˆë…•í•˜ì„¸ìš” ì—¬ëŸ¬ë¶„!',
                    type: 'text',
                    status: 'sent',
                    timestamp: new Date(Date.now() - 90000),
                },
            ],
        };

        let selectedRoom = null;
        let messageCounter = 100;

        // ì±„íŒ…ë°© ëª©ë¡ ë Œë”ë§
        function renderRooms() {
            const roomList = document.getElementById('room-list');
            roomList.innerHTML = '';

            dummyRooms.forEach(room => {
                const roomElement = document.createElement('div');
                roomElement.className = `p-3 rounded-lg cursor-pointer transition-colors room-card ${
                    selectedRoom?.id === room.id
                        ? 'bg-blue-100 border-blue-300'
                        : 'bg-gray-50 hover:bg-gray-100'
                }`;
                roomElement.onclick = () => selectRoom(room);

                roomElement.innerHTML = `
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 rounded-full bg-blue-500 flex items-center justify-center text-white">
                            ${room.avatar}
                        </div>
                        <div class="flex-1 min-w-0">
                            <h3 class="font-medium text-gray-900 truncate">
                                ${room.name}
                            </h3>
                            <p class="text-sm text-gray-500 truncate">
                                ${room.description}
                            </p>
                            <div class="flex items-center space-x-2 mt-1">
                                <span class="px-2 py-1 text-xs rounded-full ${
                                    room.type === 'private' ? 'bg-purple-100 text-purple-800' :
                                    room.type === 'team' ? 'bg-blue-100 text-blue-800' :
                                    'bg-green-100 text-green-800'
                                }">
                                    ${room.type}
                                </span>
                                <span class="text-xs text-gray-400">
                                    ${room.memberCount}ëª…
                                </span>
                            </div>
                        </div>
                    </div>
                `;

                roomList.appendChild(roomElement);
            });
        }

        // ì±„íŒ…ë°© ì„ íƒ
        function selectRoom(room) {
            selectedRoom = room;
            renderRooms();
            renderChatHeader();
            renderMessages();
            renderMembers();
            showMessageInput();
        }

        // ì±„íŒ… í—¤ë” ë Œë”ë§
        function renderChatHeader() {
            const header = document.getElementById('chat-header');
            const roomName = document.getElementById('room-name');
            const roomInfo = document.getElementById('room-info');
            const roomType = document.getElementById('room-type');
            const roomAvatar = document.getElementById('room-avatar');

            roomName.textContent = selectedRoom.name;
            roomInfo.textContent = `${selectedRoom.memberCount}ëª… ì°¸ì—¬ ì¤‘`;
            roomType.textContent = selectedRoom.type;
            roomAvatar.textContent = selectedRoom.avatar;

            header.style.display = 'block';
        }

        // ë©”ì‹œì§€ ë Œë”ë§
        function renderMessages() {
            const container = document.getElementById('messages-container');
            const messages = dummyMessages[selectedRoom.id] || [];

            container.innerHTML = '';

            messages.forEach(message => {
                const messageElement = document.createElement('div');
                messageElement.className = `flex ${message.senderId === 'user1' ? 'justify-end' : 'justify-start'}`;

                const isSent = message.senderId === 'user1';
                const bubbleClass = isSent ? 'message-sent' : 'message-received';

                messageElement.innerHTML = `
                    <div class="message-bubble ${bubbleClass} px-4 py-2">
                        <div class="flex items-center space-x-2">
                            ${getTypeIcon(message.type)}
                            <span class="text-sm">${message.content}</span>
                        </div>
                        <div class="flex items-center justify-between mt-1 ${isSent ? 'text-blue-100' : 'text-gray-500'}">
                            <span class="text-xs">
                                ${message.timestamp.toLocaleTimeString()}
                            </span>
                            ${isSent ? `
                                <span class="text-xs ${getStatusColor(message.status)}">
                                    ${getStatusText(message.status)}
                                </span>
                            ` : ''}
                        </div>
                    </div>
                `;

                container.appendChild(messageElement);
            });

            container.scrollTop = container.scrollHeight;
        }

        // ë©¤ë²„ ëª©ë¡ ë Œë”ë§
        function renderMembers() {
            const memberList = document.getElementById('member-list');
            memberList.innerHTML = '';

            dummyMembers.forEach(member => {
                const memberElement = document.createElement('div');
                memberElement.className = 'flex items-center space-x-3';

                memberElement.innerHTML = `
                    <div class="relative">
                        <div class="w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center text-lg">
                            ${member.avatar}
                        </div>
                        ${member.isOnline ? '<div class="absolute -bottom-1 -right-1 w-3 h-3 bg-green-500 rounded-full border-2 border-white"></div>' : ''}
                    </div>
                    <div class="flex-1">
                        <h3 class="font-medium text-gray-900">${member.username}</h3>
                        <div class="flex items-center space-x-2">
                            <span class="px-2 py-1 text-xs rounded-full ${
                                member.role === 'admin' ? 'bg-red-100 text-red-800' :
                                member.role === 'member' ? 'bg-blue-100 text-blue-800' :
                                'bg-gray-100 text-gray-800'
                            }">
                                ${member.role}
                            </span>
                            ${member.isDnd ? `
                                <span class="px-2 py-1 text-xs rounded-full bg-yellow-100 text-yellow-800">
                                    ë°©í•´ê¸ˆì§€
                                </span>
                            ` : ''}
                        </div>
                    </div>
                `;

                memberList.appendChild(memberElement);
            });
        }

        // ë©”ì‹œì§€ ì…ë ¥ í‘œì‹œ
        function showMessageInput() {
            document.getElementById('message-input').style.display = 'block';
        }

        // ë©”ì‹œì§€ ì „ì†¡
        function sendMessage() {
            const messageText = document.getElementById('message-text').value.trim();
            const messageType = document.getElementById('message-type').value;

            if (!messageText || !selectedRoom) return;

            const newMessage = {
                id: (++messageCounter).toString(),
                senderId: 'user1',
                senderName: 'ê¹€ì² ìˆ˜',
                content: messageText,
                type: messageType,
                status: 'sending',
                timestamp: new Date(),
            };

            if (!dummyMessages[selectedRoom.id]) {
                dummyMessages[selectedRoom.id] = [];
            }
            dummyMessages[selectedRoom.id].push(newMessage);

            document.getElementById('message-text').value = '';
            renderMessages();

            // ì‹œë®¬ë ˆì´ì…˜: ë©”ì‹œì§€ ìƒíƒœ ì—…ë°ì´íŠ¸
            setTimeout(() => {
                newMessage.status = 'sent';
                renderMessages();
            }, 1000);
        }

        // ë©”ì‹œì§€ íƒ€ì… ì•„ì´ì½˜
        function getTypeIcon(type) {
            switch (type) {
                case 'image': return 'ğŸ–¼ï¸';
                case 'file': return 'ğŸ“';
                case 'system': return 'ğŸ””';
                case 'bot': return 'ğŸ¤–';
                default: return '';
            }
        }

        // ë©”ì‹œì§€ ìƒíƒœ ìƒ‰ìƒ
        function getStatusColor(status) {
            switch (status) {
                case 'sending': return 'text-gray-400';
                case 'sent': return 'text-blue-500';
                case 'delivered': return 'text-green-500';
                case 'read': return 'text-green-600';
                case 'failed': return 'text-red-500';
                default: return 'text-gray-400';
            }
        }

        // ë©”ì‹œì§€ ìƒíƒœ í…ìŠ¤íŠ¸
        function getStatusText(status) {
            switch (status) {
                case 'sending': return 'ì „ì†¡ ì¤‘...';
                case 'sent': return 'âœ“';
                case 'delivered': return 'âœ“âœ“';
                case 'read': return 'âœ“âœ“';
                case 'failed': return 'âœ—';
                default: return '';
            }
        }

        // Enter í‚¤ë¡œ ë©”ì‹œì§€ ì „ì†¡
        document.getElementById('message-text').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

        // ì´ˆê¸°í™”
        renderRooms();
        renderMembers();

        console.log('ì±„íŒ… í…ŒìŠ¤íŠ¸ í˜ì´ì§€ê°€ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!');
    </script>
</body>
</html> 